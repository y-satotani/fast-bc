\chapter{一辺挿入時の媒介中心性の変化量}
\label{chap:update-bc-on-insert}
本章では，$G=(V,E)$に辺$e=\{\alpha,\beta\} \not\in E$を挿入して得られるグラフを
$G'=(V,E')$とする．$G'$における頂点$s$から頂点$t\,(\neq s)$への最短経路を有向グラフ
$G'_{st}=(V'_{st},E'_{st})$で表し，頂点$s$から他のすべての頂点への最短経
路を有向グラフ$G'_s=(V,E'_s)$で表す．また，$G'$における頂点$s$から
頂点$t\,(\neq s)$への最短経路の個数と長さをそれぞれ$\sigma'_{st}$, 
$d'_{st}$で表す．

\section{一辺挿入時の最短経路長の変化量}
\label{sect:update-dist-on-insert}

\begin{algorithm}[H]
  \caption{一辺挿入時の一頂点への最短経路長を更新するアルゴリズム}
  \label{algo:update-dist-on-insert}
  \begin{algorithmic}[1]
    \Require 更新対象の頂点$z$，辺挿入前の最短経路長$d_{xz},\,(x\in V)$
    \Ensure 辺挿入後の最短経路長$d'_{xz},\,(x\in V)$
    \Procedure{InsertUpdateDist}{$G,(v,w),z$}
    \State $d'_{xz}\gets d_{xz}$
    \State $SP(a,b,c)\triangleq(d'_{ac}=l_{ab}+d'_{bc})\land(d'_{ac}\neq\infty)$
    \State $\mathrm{DistAffected}\gets\varnothing$
    \State $\mathrm{DepAffected}\gets\varnothing$
    \State $\mathrm{WorkSet}\gets\{(v,w)\}$
    \State $\mathrm{VisitedVertices}\gets\{v\}$
    \While{$\mathrm{WorkSet}\neq\varnothing$}
    \State $\mathrm{WorkSet}$から有向辺$(x,u)$を取り出す
    \If{$l_{xu}+d'_{uz}<d'_{xz}$}
    \State $d'_{xz}=l_{xu}+d'_{uz}$
    \State $\mathrm{PathAffected}\gets\mathrm{PathAffected}\cup\{x\}$
    \ForAll{$y\in\mathcal{N}_G(x)$ s.t. $y\notin\mathrm{PathAffected}\land SP(y,x,v)$}
    \State $\mathrm{WorkSet}\gets\mathrm{WorkSet}\cup\{(y,x)\}$
    \State $\mathrm{VisitedVertices}\gets\mathrm{VisitedVertices}\cup\{y\}$
    \EndFor
    \ForAll{$y\in\mathcal{N}_G(x)$ s.t. $(d_{xz}=l_{xy}+d_{yz})\land(d_{xz}\neq\infty)$}
    \State $\mathrm{DepAffected}\gets\mathrm{DepAffected}\cup\{y\}$
    \EndFor
    \EndIf
    \EndWhile
    \State \textbf{return} $\mathrm{DistAffected},\mathrm{DepAffected}$
    \EndProcedure
  \end{algorithmic}
\end{algorithm}

\section{一辺挿入時の最短経路数の変化量}
\label{sect:update-sigma-on-insert}

\begin{algorithm}[H]
  \caption{一辺挿入時の一頂点への最短経路数を更新するアルゴリズム}
  \label{algo:update-sigma-on-insert}
  \begin{algorithmic}[1]
    \Require 更新対象の頂点$z$，辺挿入前の最短経路数$\sigma_{xz},\,(x\in V)$
    \Ensure 辺挿入後の最短経路数$\sigma'_{xz},\,(x\in V)$
    \Procedure{InsertUpdateSigma}{$G,(v,w),z,\mathrm{DistAffected}$}
    \State $SP(a,b,c)\triangleq(d'_{ac}=l_{ab}+d'_{bc})\land(d'_{ac}\neq\infty)$
    \State $\sigma'_{xz}\gets\sigma_{xz}$
    \State $\mathrm{PathAffected}\gets\mathrm{DistAffected}$
    \State $\mathrm{DepAffected}\gets\varnothing$
    \State $\mathrm{WorkSet}\gets\{(d'_{vw}, (v, w))\}$
    \State $\mathrm{VisitedVertices}\gets\{v\}$
    \While{$\mathrm{WorkSet}\neq\varnothing$}
    \State $\mathrm{WorkSet}$から有向辺$(x,u)$を取り出す
    \State $\sigma_{\mathrm{old}}\gets\sigma'_{xz}$
    \State $\sigma\gets\sum_{y\in \mathcal(N)_G(x)\mathrm{s.t.}SP(x,y,z)}\sigma'_{yz}$
    \State $\sigma_{xz}\gets\sigma$
    \If{$x\in\mathrm{PathAffected}\lor x\neq z\land\sigma_{\mathrm{old}}\neq\sigma$}
    \State $\sigma'_{xz}\gets\sigma$
    \State $\mathrm{PathAffected}\gets\mathrm{PathAffected}\cup\{x\}$
    \State $\mathrm{DepAffected}\gets\mathrm{DepAffected}\cup\{x\}$
    \ForAll{$y\in\mathcal{N}_G(x)$ s.t. $SP(y,x,v)\land y\notin\mathrm{VisitedVertices}$}
    \State 距離が昇順になるように$\mathrm{WorkSet}$に$(d'_{yz},(y,x))$を追加
    \State $\mathrm{VisitedVertices}\gets\mathrm{VisitedVertices}\cup\{y\}$
    \EndFor
    \EndIf
    \EndWhile
    \State \textbf{return} $\mathrm{PathAffected}$, $\mathrm{DepAffected}$
    \EndProcedure
  \end{algorithmic}
\end{algorithm}

\section{一辺挿入時のペア依存度の変化量}
\label{sect:update-pd-on-insert}

\begin{algorithm}[H]
  \caption{一辺挿入時の一頂点に対するペア依存度を更新するアルゴリズム}
  \label{algo:update-pd-on-insert}
  \begin{algorithmic}[1]
    \Require 更新対象の頂点$z$，辺挿入前のペア依存度$\delta_z(x),\,(x\in V)$
    \Ensure 辺挿入後のペア依存度$\delta'_z(x),\,(x\in V)$
    \Procedure{InsertUpdatePD}{$G,(v,w),z,\mathrm{DepAffected}$}
    \State $SP(a,b,c)\triangleq(d'_{ac}=l_{ab}+d'_{bc})\land(d'_{ac}\neq\infty)$
    \State $\delta'_z(x)\gets\delta_z(x)$
    \State $\mathrm{VisitedVertices}\gets\mathrm{DepAffected}$
    \State $\mathrm{WorkSet}\gets((d'_{xz},x)|x\in\mathrm{AffectedDependencies},x\mathrm{は}d'_{xz}\mathrm{の昇順に並べられている})$
    \While{$\mathrm{WorkSet}\neq\varnothing$}
    \State $\mathrm{WorkSet}$から頂点$x$を取り出す
    \If{$x\neq z$}
    \State $\delta'_z(x)\gets\sum_{y\in\mathcal{N}_G(x)\mathrm{s.t.}SP(y,x,z)}\frac{\sigma'_{xz}}{\sigma'_{yz}}(1+\delta'_z(y)$
    \ForAll{$y\in\mathcal{N}_G(x)\mathrm{s.t.}SP(x,y,z)$}
    \State 距離が昇順になるように$\mathrm{WorkSet}$に$(d'_{yz},y)$を追加
    \State $\mathrm{VisitedVertices}\gets\mathrm{VisitedVertices}\cup\{y\}$
    \EndFor
    \EndIf
    \EndWhile
    \EndProcedure
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
  \caption{一辺挿入時の媒介中心性更新アルゴリズム}
  \label{algo:update-bc-on-insert}
  \begin{algorithmic}[1]
    \Require グラフ$G=(V,E)$，挿入辺$\{v,w\}$とその長さ$c$
    \Ensure 辺挿入後の媒介中心性$B'(x),\,(x\in V)$
    \Procedure{InsertUpdate}{$G,(v,w),z$}
    \State $\mathrm{DistAffected},\mathrm{DepAffectedD}\gets\textproc{InsertUpdateDist}(G,(w,v),z)$
    \State $\mathrm{PathAffected},\mathrm{DepAffectedS}\gets\textproc{InsertUpdateSigma}(G,(w,v),z,\mathrm{DistAffected})$
    \State $\mathrm{DepAffected}\gets\mathrm{DepAffectedD}\cup\mathrm{DepAffectedS}$
    \State $\textproc{InsertUpdatePD}(G,(w,v),z,\mathrm{DepAffected})$
    \State \textbf{return} $\mathrm{PathAffected}$
    \EndProcedure
    \State グラフ$G$に$l_{vw}=c$として辺$\{v,w\}$を追加
    \State $\mathrm{AffectedSinks}\gets\textproc{InsertUpdate}(G,(w,v),v,d,\sigma,\delta)$
    \State $\mathrm{AffectedSources}\gets\textproc{InsertUpdate}(G,(v,w),w,d,\sigma,\delta)$
    \ForAll{$z\in\mathrm{AffectedSinks}$}
    \State $\textproc{InsertUpdate}(G,(v,w),z,d,\sigma,\delta)$
    \EndFor
    \ForAll{$z\in\mathrm{AffectedSources}$}
    \State $\textproc{InsertUpdate}(G,(w,v),z,d,\sigma,\delta)$
    \EndFor
  \end{algorithmic}
\end{algorithm}

