\chapter{更新アルゴリズム}
\label{chap:app-algorithm}

\section{Brandesのアルゴリズム}
\label{sect:app-brandes-algorithm}
\begin{algorithm}[H]
  \caption{Brandesのアルゴリズム}
  \label{algo:brandes}
  \begin{multicols}{2}
    \begin{algorithmic}[1]
      \Procedure{Brandes}{$G$}
      \State $B_x\gets 0,\:\forall x\in V$
      \ForAll{$s\in V$}
      \State $S\gets()$ \Comment スタック
      \State $P_w\gets (),\:\forall w\in V$ \Comment リスト
      \State $\sigma_t\gets 0,\:\forall t\in V;\:\sigma_s\gets 1$
      \State $d_t\gets -1,\:\forall t\in V;\:d_s\gets 0$
      \State $Q\gets ()$ \Comment 順位キュー
      \State $\mathrm{push}(Q, s)$
      \While{$\lvert Q\rvert>0$}
      \State $v\gets\mathrm{pop}(Q)$
      \State $\mathrm{push}(S, v)$
      \ForAll{$w\in\mathcal{N}_G(v)$}
      \If{$d_w<0\lor d_v+l_{vw}<d_w$}
      \State $d_w\gets d_v+l_{vw}$
      \State $\sigma_w\gets\sigma_v$
      \State $P_w\gets(v)$
      \State $\mathrm{updatekey}(Q, w, d_w)$
      \EndIf
      \If{$d_w=d_v+l_{vw}$}
      \State $\sigma_w\gets\sigma_w+\sigma_v$
      \State $\mathrm{append}(P_w, v)$
      \EndIf
      \EndFor
      \EndWhile
      \State $\delta_v\gets 0,\:v\in V$
      \While{$\lvert S\rvert>0$}
      \State $w\gets\mathrm{pop}(S)$
      \ForAll{$v\in P_w$}
      \State $\delta_v\gets\delta_v+\frac{\sigma_v}{\sigma_w}(1+\delta_w)$
      \EndFor
      \If{$w\neq s$}
      \State $B_w\gets B_w+\delta_w$
      \EndIf
      \EndWhile
      \EndFor
      \EndProcedure
    \end{algorithmic}
  \end{multicols}
\end{algorithm}

\section{一辺挿入時の更新アルゴリズム}
\label{sect:app-incremental-algorithm}
\begin{algorithm}[H]
  \caption{一辺挿入時のペア依存度を更新するアルゴリズム}
  \label{algo:incremental-algorithm}
  \begin{multicols}{2}
    \begin{algorithmic}[1]
      \Procedure{Incremental}{$G,(v,w),c$}
      \State $d'_{xz}\gets d_{xz},\quad\sigma'_{xz}\gets \sigma_{xz},\quad$
      $\delta'_z(x)\gets \delta_z(x)\quad \forall x,z\in V(G)$
      \State $G'\gets(V(G),E(G)\cup\{(v,w)\}),\quad l_{vw}\gets c$
      \ForAll{$z\in V(G)$}
      \If{$l_{vz}>l_{wz}$}
      \State $\textsc{IncrementalPart}(G',(v,w),z)$
      \Else
      \State $\textsc{IncrementalPart}(G',(w,v),z)$
      \EndIf
      \EndFor
      \EndProcedure
      \Procedure{IncrementalPart}{$G',(v,w),z$}
      \If{$d_{wz}=\infty\lor d_{vz}<l_{vw}+d_{wz}$}
      \State \textbf{return}
      \EndIf
      \State $Q\gets((v,l_{vw}+d_{wz}))$
      \Comment 各要素の第二要素をキーとする順位キュー
      \State $\delta S\gets\{\}$
      \Comment $\delta_z(x)$を更新する頂点集合
      \While{$\lvert Q\rvert>0$}
      \State $x,\hat{d}_{xz}\gets\mathrm{popmin}(Q)$
      \State $d'_{xz}\gets\hat{d}_{xz},\quad\sigma'_{xz}\gets 0$
      \ForAll{$y\in\mathcal{N}_{G'}(x)$}
      \If{$d'_{yz}\geq l_{yx}+d'_{xz}$}
      \State $\mathrm{updatekey}(Q,y,l_{yx}+d_{xz})$
      \EndIf
      \If{$d'_{xz}=l_{xy}+d'_{yz}$}
      \State $\sigma'_{xz}\gets\sigma'_{xz}+\sigma'_{yz}$
      \EndIf
      \If{$(d_{xz}=l_{xy}+d_{yz}\land\lnot(y=w\land x=v))$
        $\veebar(d'_{xz}=l_{xy}+d'_{yz})$}
      \State $S\gets S\cup\{y\}$
      \EndIf
      \EndFor
      \If{$\sigma'_{xz}\neq\sigma_{xz}$}
      \State $S\gets S\cup\{x\}$
      \EndIf
      \EndWhile
      \State $R\gets((x,d'_{xz})\vert x\in S)$
      \Comment 各要素の第二要素をキーとする順位キュー
      \While{$\lvert R\rvert>0$}
      \State $x,\_\gets\mathrm{popmax}(R)$
      \State $\delta'_z(x)\gets 0$
      \If{$x=z$}
      \State \textbf{continue}
      \EndIf
      \ForAll{$y\in\mathcal{N}_G(x)$}
      \If{$d'_{yz}=l_{yx}+d'_{xz}$}
      \State $\delta'_z(x)\gets\delta'_z(x)$
      $+\frac{\sigma'_{xz}}{\sigma'_{yz}}(1+\delta'_z(y)$
      \ElsIf{$d_{zx}=l_{xy}+d_{yz}$}
      \State $\mathrm{updatekey}(R, y, d'_{yz})$
      \EndIf
      \EndFor
      \EndWhile
      \EndProcedure
    \end{algorithmic}
  \end{multicols}
\end{algorithm}

\section{一辺削除時の更新アルゴリズム}
\label{sect:app-decremental-algorithm}
\begin{algorithm}[H]
  \caption{一辺挿入時のペア依存度を更新するアルゴリズム}
  \label{algo:decremental-algorithm}
  \begin{multicols}{2}
    \begin{algorithmic}[1]
      \Procedure{Decremental}{$G,(v,w),c$}
      \State $d'_{xz}\gets d_{xz},\quad\sigma'_{xz}\gets \sigma_{xz},\quad$
      $\delta'_z(x)\gets \delta_z(x)\quad \forall x,z\in V(G)$
      \State $G'\gets(V(G),E(G)\cup\{(v,w)\}),\quad l_{vw}\gets c$
      \ForAll{$z\in V(G)$}
      \If{$l_{vz}>l_{wz}$}
      \State $\textsc{DecrementalPart}(G',(v,w),z)$
      \Else
      \State $\textsc{DecrementalPart}(G',(w,v),z)$
      \EndIf
      \EndFor
      \EndProcedure
      \Procedure{DecrementalPart}{$G',(v,w),z$}
      \If{$d_{wz}=\infty\lor d_{vz}<l_{vw}+d_{wz}$}
      \State \textbf{return}
      \EndIf
      \State $\mathrm{WorkSet}\gets\{v\}$
      \State $\mathrm{Affected}\gets\{v\}$
      \While{$\lvert\mathrm{WorkSet}\rvert>0$}
      \State $x\gets\mathrm{pop}(\mathrm{WorkSet})$
      \ForAll{$y\in\mathcal{N}_{G'}(x)$}
      \If{$d_{yz}=l_{yx}+d_{xz}\land y\notin\mathrm{Affected}$}
      \State $\mathrm{Affected}\gets\mathrm{Affected}\cup\{y\},\quad$
      $\mathrm{WorkSet}\gets\mathrm{WorkSet}\cup\{y\}$
      \EndIf
      \EndFor
      \EndWhile
      \State $Q\gets()$
      \Comment 各要素の第二要素をキーとする順位キュー
      \ForAll{$x\in\mathrm{Affected}$}
      \State $\hat{d}_{xz}\gets\min($
      $\{l_{xy}+d_{yz}\vert$
      $y\in\mathcal{N}_{G'}(x),\:y\notin\mathrm{Affected}\}$
      $\cup\{\infty\})$
      \If{$\hat{d}_{xz}=\infty$}
      \State $d'_{xz}\gets\infty,\quad\sigma'_{xz}\gets 0$
      \Else
      \State $\mathrm{updatekey}(Q, x, \hat{d}_{xz})$
      \EndIf
      \EndFor
      \State $S\gets\{w\}$
      \Comment $\delta_z(x)$を更新する頂点集合
      \While{$\lvert Q\rvert>0$}
      \State $x,\hat{d}_{xz}\gets\mathrm{popmin}(Q)$
      \State $\mathrm{Affected}\gets\mathrm{Affected}\setminus\{x\}$
      \State $d'_{xz}\gets\hat{d}_{xz},\quad\sigma'_{xz}\gets 0$
      \ForAll{$y\in\mathrm{Affected}$}
      \If{$d'_{yz}\geq l_{yx}+d'_{xz}$}
      \State $\mathrm{updatekey}(Q,y,l_{yx}+d_{xz})$
      \EndIf
      \If{$d'_{xz}=l_{xy}+d'_{yz}$}
      \State $\sigma'_{xz}\gets\sigma'_{xz}+\sigma'_{yz}$
      \EndIf
      \If{$d_{xz}=l_{xy}+d_{yz}\veebar d'_{xz}=l_{xy}+d'_{yz}$}
      \State $S\gets S\cup\{y\}$
      \EndIf
      \If{$d_{yz}=l_{yx}+d_{xz}\veebar d'_{yz}=l_{yx}+d'_{xz}$}
      \State $S\gets S\cup\{x\}$
      \EndIf
      \EndFor
      \If{$\sigma'_{xz}\neq\sigma_{xz}$}
      \State $S\gets S\cup\{x\}$
      \EndIf
      \EndWhile
      \State $S\gets S\cup\mathrm{Affected}$
      \State $\mathrm{Affected}\gets\varnothing$
      \State $R\gets((x,d'_{xz})\vert x\in S)$
      \Comment 各要素の第二要素をキーとする順位キュー
      \While{$\lvert R\rvert>0$}
      \State $x,\_\gets\mathrm{popmax}(R)$
      \State $\delta'_z(x)\gets 0$
      \If{$x=z$}
      \State \textbf{continue}
      \EndIf
      \ForAll{$y\in\mathcal{N}_G(x)$}
      \If{$d'_{yz}=l_{yx}+d'_{xz}$}
      \State $\delta'_z(x)\gets\delta'_z(x)$
      $+\frac{\sigma'_{xz}}{\sigma'_{yz}}(1+\delta'_z(y)$
      \ElsIf{$d_{zx}=l_{xy}+d_{yz}$}
      \State $\mathrm{updatekey}(R, y, d'_{yz})$
      \EndIf
      \EndFor
      \EndWhile
      \EndProcedure
    \end{algorithmic}
  \end{multicols}
\end{algorithm}
